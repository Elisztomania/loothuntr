<div class="container">
<% if current_user.is_member_of?(@guild) %>

<!-- BUTTON MODIF GUILDE QUE PAR CREATOR-->
    <h1 class="text-center pt-16 text-2xl">Tableau de bord : <%= @guild.name %>
      <% if current_user == @guild.creator %>
        <%= link_to edit_guild_path(@guild) do %>
          <i class="fas fa-pencil-alt text-sm"></i>
        <% end %>
      <% end %>
    </h1>

    <br>

<!-- FORMULAIRE POSTS ORGA -->
    <div class="card">
      <%= simple_form_for [@guild, @post_new] do |f| %>
        <%= f.hidden_field :category, value: 'orga' %>
        <%= f.input :title, label: 'Titre'  %>
        <%= f.input :description, label: 'Description'  %>
        <%= f.button :submit, '>', class: 'btn btn-primary' %>
      <% end %>
    </div>
<br>
<!-- AFFICHAGE POSTS ORGA -->
  <div class="h-80 overflow-auto">
    <h2 class="text-xl">Derniers posts</h2>
      <% @guild.posts.reverse_each do |post| %>
        <% if post.category == "orga" %>
        <div class="p-2 rounded-xl bg-gray-50 my-2">
          <strong><h3><%= post.title %></h3></strong>
          <p><%= post.description %></p>

          <div class="p-2">
            <% post.comments.each do |comment| %>
            <div class="bg-gray-100 my-1 rounded-xl pl-2 -pb-2">
              <p><m class="italic text-sm"><%= comment.user.username %> : </m><%= comment.content %></p>
            </div>
            <% end %>

            <%= simple_form_for [post, @comment_new] do |f| %>
              <%= f.input_field :content, label: false, placeholder: "Votre commentaire" %>
              <%= f.button :submit, '>', class: 'btn btn-primary' %>
            <% end %>
          </div>
        </div>
        <% end %>
      <% end %>
    </div>

<!-- DEBUT CANDIDATURES POUR REJOINDRE VISIBLE QUE PAR CREATOR -->
    <% if @guild.creator == current_user && @guild.members.waiting.present? %>
      <h2>Des personnes veulent entrer dans votre guilde</h2>
      <br>
      <% @guild.members.waiting.each do |member| %>
          <strong><h3><%= member.user.username %></h3></strong>
          <p ><%= member.cover_letter %></p>
          <%= link_to "", accepted_member_path(member), class: "fas fa-check-circle", style: "color: green; font-size: 20px;" %>
          <%= link_to "", refused_member_path(member), class: "fas fa-times-circle", style: "color: red; font-size: 20px;"%>
        <% end %>
    <% end %>
<!-- FIN CANDIDATURES POUR REJOINDRE VISIBLE QUE PAR CREATOR -->

    <br>
    <hr>
    <br>

<!-- DEBUT LISTE MEMBRES DE LA GUIDE -->
    <h2 class="text-xl"> La guilde </h2>
    <% @guild.members.each do |member| %>
      <% if member.accepted == true %>
        <strong><p><%= member.user.username %></p></strong>
        <p><%= member.user.bio %></p>
      <% end %>
    <% end %>
<!-- FIN LISTE MEMBRES DE LA GUIDE -->

    <br>
    <hr>
    <br>

<!-- BUTTON PISTE-->
    <%= link_to 'Voir les pistes en cours', pistes_guild_posts_path(@guild), class: "btn btn-primary" %>



<!-- BUTTON RETOUR-->
  <%= link_to 'Voir la quÃªte', quest_path(@guild.quest), class: "btn btn-primary" %>


<!-- A LAISSER EN BAS, SI T'ES PAS MEMBRE, TU VOIS RIEN -->
<% else %>
  <h2>DÃ©solÃ©, vous n'Ãªtes pas member de cette guilde ğŸ˜‰</h2>
<% end %>
</div>
